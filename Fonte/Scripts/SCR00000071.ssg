/************************************************************
 * Autor........: Jeimyson Souza
 * Modulo.......: Todos
 * Data/Hora....: 02/06/2013 13:34:37
 * Obj. Ult Alt.: Script Oficial 71
 ************************************************************/

DROP VIEW IF EXISTS vwempresa; 
CREATE OR REPLACE FUNCTION script_71() RETURNS void
AS $$
BEGIN
	/*
	* Cria tabela de Estados (UF)
	*/ 
	IF  NOT EXISTS(
	    	SELECT NULL FROM information_schema.tables
	    	WHERE TABLE_NAME      = 'tbuf'
	    )
	THEN
	CREATE TABLE IF NOT EXISTS tbuf
	(
		icodigo     serial NOT NULL,	-- CODIGO IDENTIFICADOR DA TABELA
		codigoibge  INTEGER NOT NULL,	-- Código Padrão da UF (IBGE).
		nmestado    VARCHAR (300) NOT NULL,	-- Nome do Estado.
		uf          VARCHAR (2) NOT NULL,	-- Unidade Federativa (UF).
		CONSTRAINT tbuf_pkey PRIMARY KEY (icodigo)
	) WITH (OIDS = FALSE); 
	
	ALTER TABLE tbuf 
	OWNER TO postgres; 
	
	COMMENT ON COLUMN tbuf.icodigo IS 'código identificador da tabela'; 
	COMMENT ON COLUMN tbuf.codigoibge IS 'Código Padrão da UF (IBGE).'; 
	COMMENT ON COLUMN tbuf.nmestado IS 'Nome do Estado.'; 
	COMMENT ON COLUMN tbuf.uf IS 'Unidade Federativa (UF).';

	END IF;
	/*
	* Insere estados (UF)
	*/

	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'11',
		'Rondônia',
		'RO'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '11'
	       );

	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'12',
		'Acre',
		'AC'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '12'
	       );

	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'13',
		'Amazonas',
		'AM'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '13'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'14',
		'Roraima',
		'RR'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '14'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'15',
		'Pará',
		'PA'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '15'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'16',
		'Amapá',
		'AP'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '16'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'17',
		'Tocantins',
		'TO'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '17'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'21',
		'Maranhão',
		'MA'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '21'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'22',
		'Piauí',
		'PI'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '22'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'23',
		'Ceará',
		'CE'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '23'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'24',
		'Rio Grande do Norte',
		'RN'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '24'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'25',
		'Paraíba',
		'PB'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '25'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'26',
		'Pernambuco',
		'PE'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '26'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'27',
		'Alagoas',
		'AL'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '27'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'28',
		'Sergipe',
		'SE'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '28'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'29',
		'Bahia',
		'BA'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '29'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'31',
		'Minas Gerais',
		'MG'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '31'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'32',
		'Espírito Santo',
		'ES'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '32'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'33',
		'Rio de Janeiro',
		'RJ'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '33'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'35',
		'São Paulo',
		'SP'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '35'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'41',
		'Paraná',
		'PR'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '41'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'42',
		'Santa Catarina',
		'SC'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '42'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'43',
		'Rio Grande do Sul',
		'RS'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '43'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'50',
		'Mato Grosso do Sul',
		'MS'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '50'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'51',
		'Mato Grosso',
		'MT'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '51'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'52',
		'Goiás',
		'GO'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '52'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'53',
		'Distrito Federal',
		'DF'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '53'
	       ); 
	
	
	/*
	- Cria coluna iEstado na tabela de Cidades
	*/
	IF  NOT EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbcidade'
	    	   AND COLUMN_NAME = 'iuf'
	    )
	THEN
		ALTER TABLE tbcidade ADD COLUMN iuf INT NULL; 
		COMMENT ON COLUMN tbuf.icodigo IS 
		'indica o identificador da tabela de estados (uf).';
	END IF;
	
	IF EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbcidade'
	    	   AND COLUMN_NAME = 'suf'
	    )
	THEN
		UPDATE tbcidade
		SET    iuf = u.icodigo
		FROM   tbcidade c
			   LEFT JOIN tbuf u
					ON  u.uf = c.suf
		WHERE  tbcidade.icodigo = c.icodigo;
	END IF;
	
	/*
	* Altera view de Pedido para contemplar a tabela de uf
	*/
	DROP VIEW vwPedido;

	CREATE OR REPLACE VIEW vwpedido AS 
	SELECT tbpedido.icodigo
		  ,COALESCE(tbpedido.icliente, 0) AS icliente
		  ,tbpedido.ddatapedido
		  ,tbpedido.thorapedido
		  ,tbpedido.ntotalprodutos
		  ,tbpedido.najustepercentual
		  ,tbnatureza.sdescricao AS natureza
		  ,tbpedido.icfop AS cfop
		  ,COALESCE(
			   COALESCE(tbconsumidor.snome, tbpessoa.snome),
			   'CONSUMIDOR'::character VARYING
		   ) AS cliente
		  ,COALESCE(tbconsumidor.sendereco, tbpessoa.sendereco) AS sendereco
		  ,COALESCE(tbconsumidor.sbairro, tbpessoa.sbairro) AS sbairro
		  ,COALESCE(tbconsumidor.scep, tbpessoa.scep::character VARYING) AS scep
		  ,COALESCE(tbpessoafisica.scpf, tbpessoajuridica.scnpj) AS cpf_cnpj
		  ,COALESCE(tbcidadeconsumidor.snome, tbcidade.snome) AS cidade
		  ,COALESCE(tbufconsumidor.uf, tbuf.uf) AS suf
		  ,COALESCE(tbconsumidor.sfone, tbpessoa.sfone::character VARYING) AS sfone
		  ,tbpessoajuridica.sinscestadual
		  ,(tbproduto.sdescricao::TEXT || ' - '::TEXT) || tbproduto.sreferencia::TEXT AS sdescricao
		  ,tbmarca.sdescricao AS marca
		  ,tbproduto.icodigo AS iproduto
		  ,tbunidade.sdescricao AS unidade
		  ,tbcodigofiscal.nicmspf
		  ,tbcodigofiscal.nicmspj
		  ,tbpedido.sobservacao
		  ,tbpedidoitens.nquantidade
		  ,tbpedidoitens.nvalor
		  ,tbpedidoitens.nquantidade * tbpedidoitens.nvalor AS totalitem
		  ,CASE 
				WHEN tbpedido.najustepercentual > 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC)
				ELSE 0.00
		   END AS totalacresc
		  ,CASE 
				WHEN tbpedido.najustepercentual < 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC)
				ELSE 0.00
		   END AS totaldesc
		  ,(
			   tbpedidoitens.nvalor +
			   CASE 
					WHEN tbpedido.najustepercentual < 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC) 
						 / tbpedidoitens.nquantidade
					ELSE 0.00
			   END +
			   CASE 
					WHEN tbpedido.najustepercentual > 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC) 
						 / tbpedidoitens.nquantidade
					ELSE 0.00
			   END
		   )::NUMERIC(12, 2) AS nvalorcomajuste
		  ,(
			   tbpedidoitens.nquantidade * tbpedidoitens.nvalor + tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC)
		   )::NUMERIC(12, 2) AS totalitemcomajuste
		  ,tbpedido.sstatus
		  ,CASE 
				WHEN tbpedido.bpedido = TRUE AND tbpedido.icodnotafiscal IS NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = FALSE THEN 'Pedido'::TEXT
				WHEN tbpedido.bpedido = FALSE AND tbpedido.icodnotafiscal IS NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = FALSE THEN 'Orçamento'::TEXT
				WHEN tbpedido.bpedido = TRUE AND tbpedido.icodnotafiscal IS NOT NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = FALSE THEN 'NF'::TEXT
				WHEN tbpedido.bpedido = FALSE AND tbpedido.icodnotafiscal IS NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = TRUE THEN 'CF'::TEXT
				ELSE NULL::TEXT
		   END::character VARYING(10) AS tipo
		  ,nf.inotafiscal
	FROM   tbpedido
	JOIN tbpedidoitens ON tbpedidoitens.ipedido = tbpedido.icodigo
	LEFT JOIN tbnotafiscal nf ON nf.icodigo = tbpedido.icodnotafiscal
	LEFT JOIN tbcliente ON tbcliente.icodigo = tbpedido.icliente
	LEFT JOIN tbpessoa ON tbpessoa.icodigo = tbcliente.icodigo
	JOIN tbproduto ON tbproduto.icodigo = tbpedidoitens.iproduto
	JOIN tbnatureza ON tbnatureza.icodigo = tbpedido.inatureza
	LEFT JOIN tbpessoafisica ON tbpessoafisica.icodigo = tbpessoa.icodigo
	LEFT JOIN tbpessoajuridica ON tbpessoajuridica.icodigo = tbpessoa.icodigo
	LEFT JOIN tbcidade ON tbcidade.icodigo = tbpessoa.icidade
	LEFT JOIN tbuf ON tbuf.icodigo = tbcidade.iuf
	JOIN tbunidade ON tbunidade.icodigo = tbproduto.iundsaida
	JOIN tbcodigofiscal ON tbcodigofiscal.icodigo = tbpedido.icfop
	JOIN tbmarca ON tbmarca.icodigo = tbproduto.imarca
	LEFT JOIN tbconsumidor ON tbconsumidor.ipedido = tbpedido.icodigo
	LEFT JOIN tbcidade tbcidadeconsumidor ON tbcidadeconsumidor.icodigo = tbconsumidor.icidade
	LEFT JOIN tbuf tbufconsumidor ON tbufconsumidor.icodigo = tbcidadeconsumidor.iuf 
	WHERE  tbpedido.sstatus = 'A'::bpchar;
	
	/*
	- Apaga coluna suf da tabela tbcidade
	*/
	IF EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbcidade'
	    	   AND COLUMN_NAME = 'suf'
	    )
	THEN
		ALTER TABLE tbcidade DROP COLUMN suf; 
	END IF;	
	
	/*
	- Cria view de empresa
	*/
	CREATE OR REPLACE VIEW vwEmpresa
	AS
	select 
		e.*,
		c.snome as scidade,
		c.scodibge as scodibgecidade,
		c.iuf,
		u.nmestado as sestado,
		u.uf as suf,
		u.codigoibge as scodibgeuf
	from tbempresa e
	inner join tbcidade c on c.icodigo = e.icidade
	inner join tbuf u on u.icodigo = c.iuf;	
	
	/*
	* Cria parametro de Versão da NF
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodVerNFE'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Versão de NFE', 'CodVerNFE', '2', 1);
	END IF;	
	
	/*
	* Cria parametro Tipo da NF
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodTpoNFE'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Tipo de NFE', 'CodTpoNFE', '1', 1);
	END IF;		

	/*
	* Cria parametro Formato DANFE
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodFormatoDanfe'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Formato do Danfe', 'CodFormatoDanfe', '1', 1);
	END IF;			
	
	/*
	* Cria parametro Forma de Emissão
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodFormaEmissao'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código da Forma de Emissão', 'CodFormaEmissao', '1', 1);
	END IF;		
	
	/*
	* Cria parametro Código do Ambiente NFE
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodAmbienteNfe'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Ambiente de NFE (1 = producao 2 = homologacao)', 'CodAmbienteNfe', '1', 1);
	END IF;			
	
	/*
	* Cria parametro Código da Finalidade NFE
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodFinalidadeNFE'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código da Finalidade de NFE', 'CodFinalidadeNFE', '1', 1);
	END IF;	
	
	/*
	* Cria tabela de Estados (UF)
	*/ 
	IF  NOT EXISTS(
	    	SELECT NULL FROM information_schema.tables
	    	WHERE TABLE_NAME      = 'tbpais'
	    )
	THEN
	CREATE TABLE IF NOT EXISTS tbpais
	(
		icodigo     serial NOT NULL,		-- CODIGO IDENTIFICADOR DA TABELA
		icodigopais VARCHAR (10) NOT NULL,	-- Código Nacional do País
		sPais       VARCHAR (300) NOT NULL,	-- Nome do País.
		CONSTRAINT tbpais_pkey PRIMARY KEY (icodigo)
	) WITH (OIDS = FALSE); 
	
	ALTER TABLE tbpais 
	OWNER TO postgres; 
	
	COMMENT ON COLUMN tbpais.icodigo IS 'código identificador da tabela'; 
	COMMENT ON COLUMN tbpais.icodigopais IS 'Código Nacional do País'; 
	COMMENT ON COLUMN tbpais.sPais IS 'Nome do País.'; 

	END IF;	

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00132'
		  ,'Afeganistão'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00132'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00175'
		  ,'Republica Da Albania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00175'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00230'
		  ,'Alemanha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00230'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00310'
		  ,'Burkina Faso'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00310'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00370'
		  ,'Andorra'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00370'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00400'
		  ,'Angola'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00400'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00418'
		  ,'Anguilla'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00418'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00434'
		  ,'Antigua E Barbuda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00434'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00531'
		  ,'Arabia Saudita'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00531'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00639'
		  ,'Argentina'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00639'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00647'
		  ,'Republica Da Armenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00647'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00698'
		  ,'Australia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00698'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00728'
		  ,'Austria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00728'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00736'
		  ,'Republica Do Azerbaijao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00736'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00779'
		  ,'Ilhas Bahamas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00779'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00809'
		  ,'Ilhas Bahrein'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00809'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00817'
		  ,'Bangladesh'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00817'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00833'
		  ,'Barbados'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00833'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00850'
		  ,'Republica Da Belarus'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00850'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00876'
		  ,'Belgica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00876'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00884'
		  ,'Belize'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00884'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00906'
		  ,'Bermudas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00906'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00930'
		  ,'Mianmar (Birmania)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00930'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00973'
		  ,'Bolivia, Estado Plurinacional Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00973'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00981'
		  ,'Bosnia-Herzegovina (Republica Da)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00981'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01015'
		  ,'Botsuana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01015'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01058'
		  ,'Brasil'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01058'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01082'
		  ,'Brunei'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01082'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01112'
		  ,'Bulgaria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01112'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01155'
		  ,'Burundi'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01155'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01198'
		  ,'Butao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01198'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01279'
		  ,'Republica De Cabo Verde'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01279'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01376'
		  ,'Ilhas Cayman'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01376'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01414'
		  ,'Camboja'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01414'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01457'
		  ,'Camaroes'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01457'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01490'
		  ,'Canada'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01490'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01504'
		  ,'Ilha Do Canal Guernsey'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01504'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01508'
		  ,'Ilha Do Canal Jersey'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01508'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01511'
		  ,'Ilhas Canarias'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01511'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01538'
		  ,'Republica Do Cazaquistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01538'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01546'
		  ,'Catar'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01546'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01589'
		  ,'Chile'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01589'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01600'
		  ,'China'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01600'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01619'
		  ,'Formosa (Taiwan)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01619'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01635'
		  ,'Chipre'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01635'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01651'
		  ,'Ilhas Cocos(Keeling)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01651'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01694'
		  ,'Colombia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01694'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01732'
		  ,'Ilhas Comores'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01732'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01775'
		  ,'Congo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01775'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01830'
		  ,'Ilhas Cook'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01830'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01872'
		  ,'Coreia (Do Norte), Rep.Pop.Democratica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01872'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01902'
		  ,' Republica Da Coreia (Do Sul)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01902'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01937'
		  ,'Costa Do Marfim'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01937'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01953'
		  ,'Croacia (Republica)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01953'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01961'
		  ,'Costa Rica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01961'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01988'
		  ,'Coveite'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01988'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01996'
		  ,'Cuba'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01996'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02291'
		  ,'Benin'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02291'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02321'
		  ,'Dinamarca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02321'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02356'
		  ,'Dominica,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02356'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02399'
		  ,'Equador'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02399'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02402'
		  ,'Egito'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02402'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02437'
		  ,'Eritreia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02437'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02445'
		  ,'Emirados Arabes Unidos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02445'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02453'
		  ,'Espanha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02453'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02461'
		  ,'Republica Da Eslovenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02461'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02470'
		  ,'Republica Eslovaca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02470'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02496'
		  ,'Estados Unidos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02496'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02518'
		  ,'Republica Da Estonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02518'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02534'
		  ,'Etiopia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02534'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02550'
		  ,'Falkland (Ilhas Malvinas)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02550'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02593'
		  ,'Ilhas Feroe'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02593'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02674'
		  ,'Filipinas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02674'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02712'
		  ,'Finlandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02712'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02755'
		  ,'Franca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02755'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02810'
		  ,'Gabao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02810'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02852'
		  ,'Gambia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02852'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02895'
		  ,'Gana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02895'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02917'
		  ,'Republica Da Georgia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02917'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02933'
		  ,'Gibraltar'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02933'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02976'
		  ,'Granada'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02976'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03018'
		  ,'Grecia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03018'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03050'
		  ,'Groenlandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03050'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03093'
		  ,'Guadalupe'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03093'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03131'
		  ,'Guam'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03131'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03174'
		  ,'Guatemala'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03174'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03255'
		  ,'Guiana Francesa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03255'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03298'
		  ,'Guine'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03298'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03310'
		  ,'Guine-Equatorial'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03310'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03344'
		  ,'Guine-Bissau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03344'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03379'
		  ,'Guiana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03379'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03417'
		  ,'Haiti'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03417'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03450'
		  ,'Honduras'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03450'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03514'
		  ,'Hong Kong'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03514'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03557'
		  ,'Republica Da Hungria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03557'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03573'
		  ,'Iemen'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03573'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03595'
		  ,'Man, Ilha De'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03595'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03611'
		  ,'India'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03611'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03654'
		  ,'Indonesia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03654'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03697'
		  ,'Iraque'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03697'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03727'
		  ,'Republica Islamica Do Ira'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03727'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03751'
		  ,'Irlanda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03751'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03794'
		  ,'Islandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03794'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03832'
		  ,'Israel'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03832'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03867'
		  ,'Italia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03867'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03913'
		  ,'Jamaica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03913'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03964'
		  ,'Ilhas Johnston'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03964'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03999'
		  ,'Japao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03999'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04030'
		  ,'Jordania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04030'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04111'
		  ,'Kiribati'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04111'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04200'
		  ,'Laos, Rep.Pop.Democr.Do'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04200'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04235'
		  ,'Ilhas Lebuan'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04235'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04260'
		  ,'Lesoto'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04260'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04278'
		  ,'Republica Da Letonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04278'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04316'
		  ,'Libano'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04316'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04340'
		  ,'Liberia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04340'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04383'
		  ,'Libia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04383'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04405'
		  ,'Liechtenstein'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04405'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04421'
		  ,'Republica Da Lituania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04421'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04456'
		  ,'Luxemburgo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04456'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04472'
		  ,'Macau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04472'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04499'
		  ,'Macedonia, Ant.Rep.Iugoslava'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04499'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04502'
		  ,'Madagascar'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04502'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04525'
		  ,'Madeira, Ilha Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04525'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04553'
		  ,'Malasia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04553'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04588'
		  ,'Malavi'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04588'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04618'
		  ,'Maldivas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04618'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04642'
		  ,'Mali'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04642'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04677'
		  ,'Malta'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04677'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04723'
		  ,'Marianas Do Norte'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04723'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04740'
		  ,'Marrocos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04740'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04766'
		  ,'Ilhas Marshall'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04766'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04774'
		  ,'Martinica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04774'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04855'
		  ,'Mauricio'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04855'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04880'
		  ,'Mauritania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04880'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04885'
		  ,'Mayotte (Ilhas Francesas)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04885'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04901'
		  ,'Ilhas Midway'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04901'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04936'
		  ,'Mexico'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04936'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04944'
		  ,'Republica Da Moldavia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04944'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04952'
		  ,'Monaco'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04952'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04979'
		  ,'Mongolia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04979'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04985'
		  ,'Montenegro'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04985'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04995'
		  ,'Micronesia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04995'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05010'
		  ,'Ilhas Montserrat'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05010'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05053'
		  ,'Mocambique'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05053'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05070'
		  ,'Namibia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05070'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05088'
		  ,'Nauru'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05088'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05118'
		  ,'Christmas,Ilha (Navidad)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05118'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05177'
		  ,'Nepal'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05177'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05215'
		  ,'Nicaragua'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05215'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05258'
		  ,'Niger'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05258'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05282'
		  ,'Nigeria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05282'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05312'
		  ,'Niue,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05312'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05355'
		  ,'Norfolk,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05355'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05380'
		  ,'Noruega'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05380'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05428'
		  ,'Nova Caledonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05428'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05452'
		  ,'Papua Nova Guine'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05452'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05487'
		  ,'Nova Zelandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05487'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05517'
		  ,'Vanuatu'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05517'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05568'
		  ,'Oma'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05568'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05665'
		  ,'Ilhas Do Pacifico (Possessao Dos Eua)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05665'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05738'
		  ,'Paises Baixos (Holanda)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05738'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05754'
		  ,'Palau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05754'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05762'
		  ,'Paquistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05762'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05800'
		  ,'Panama'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05800'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05860'
		  ,'Paraguai'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05860'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05894'
		  ,'Peru'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05894'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05932'
		  ,'Pitcairn,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05932'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05991'
		  ,'Polinesia Francesa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05991'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06033'
		  ,'Republica Da Polonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06033'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06076'
		  ,'Portugal'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06076'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06114'
		  ,'Porto Rico'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06114'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06238'
		  ,'Quenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06238'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06254'
		  ,'Republica Quirguiz'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06254'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06289'
		  ,'Reino Unido'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06289'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06408'
		  ,'Republica Centro-Africana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06408'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06475'
		  ,'Republica Dominicana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06475'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06602'
		  ,'Reuniao, Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06602'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06653'
		  ,'Zimbabue'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06653'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06700'
		  ,'Romenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06700'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06750'
		  ,'Ruanda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06750'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06769'
		  ,'Russia, Federacao Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06769'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06777'
		  ,'Ilhas Salomao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06777'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06858'
		  ,'Saara Ocidental'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06858'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06874'
		  ,'El Salvador'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06874'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06904'
		  ,'Samoa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06904'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06912'
		  ,'Samoa Americana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06912'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06955'
		  ,'Ilhas Sao Cristovao E Neves'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06955'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06971'
		  ,'San Marino'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06971'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07005'
		  ,'Sao Pedro E Miquelon'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07005'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07056'
		  ,'Sao Vicente E Granadinas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07056'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07102'
		  ,'Santa Helena'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07102'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07153'
		  ,'Santa Lucia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07153'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07200'
		  ,'Ilhas Sao Tome E Principe'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07200'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07285'
		  ,'Senegal'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07285'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07315'
		  ,'Seychelles'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07315'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07358'
		  ,'Serra Leoa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07358'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07370'
		  ,'Servia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07370'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07412'
		  ,'Cingapura'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07412'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07447'
		  ,'Republica Arabe Da Siria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07447'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07480'
		  ,'Somalia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07480'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07501'
		  ,'Sri Lanka'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07501'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07544'
		  ,'Suazilandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07544'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07560'
		  ,'Africa Do Sul'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07560'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07595'
		  ,'Sudao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07595'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07641'
		  ,'Suecia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07641'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07676'
		  ,'Suica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07676'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07706'
		  ,'Suriname'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07706'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07722'
		  ,'Republica Do Tadjiquistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07722'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07765'
		  ,'Tailandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07765'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07803'
		  ,'Tanzania, Rep.Unida Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07803'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07820'
		  ,'Territorio Brit.Oc.Indico'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07820'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07838'
		  ,'Djibuti'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07838'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07889'
		  ,'Chade'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07889'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07919'
		  ,'Republica Tcheca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07919'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07951'
		  ,'Timor Leste'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07951'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08001'
		  ,'Togo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08001'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08052'
		  ,'Ilhas Toquelau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08052'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08109'
		  ,'Tonga'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08109'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08150'
		  ,'Trinidad E Tobago'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08150'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08206'
		  ,'Tunisia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08206'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08230'
		  ,'Ilhas Turcas E Caicos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08230'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08249'
		  ,'Republica Do Turcomenistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08249'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08273'
		  ,'Turquia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08273'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08281'
		  ,'Tuvalu'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08281'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08311'
		  ,'Ucrania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08311'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08338'
		  ,'Uganda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08338'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08451'
		  ,'Uruguai'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08451'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08478'
		  ,'Republica Do Uzbequistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08478'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08486'
		  ,'Est. Da Cidade Do Vaticano'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08486'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08508'
		  ,'Venezuela'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08508'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08583'
		  ,'Vietna'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08583'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08630'
		  ,'Ilhas Virgens (Britanicas)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08630'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08664'
		  ,'Ilhas Virgens (E.U.A.)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08664'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08702'
		  ,'Fiji'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08702'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08737'
		  ,'Ilha Wake'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08737'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08885'
		  ,'Republica Democratica Do Congo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08885'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08907'
		  ,'Zambia'
		
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08907'
		   );
		   
	
END;	
$$ LANGUAGE plpgsql;
SELECT script_71();
DROP FUNCTION script_71 ();/************************************************************
 * Autor........: Jeimyson Souza
 * Modulo.......: Todos
 * Data/Hora....: 02/06/2013 13:34:37
 * Obj. Ult Alt.: Script Oficial 71
 ************************************************************/
 
CREATE OR REPLACE FUNCTION script_71() RETURNS void
AS $$
BEGIN
	/*
	* Cria tabela de Estados (UF)
	*/ 
	IF  NOT EXISTS(
	    	SELECT NULL FROM information_schema.tables
	    	WHERE TABLE_NAME      = 'tbcidade'
	    )
	THEN
	CREATE TABLE IF NOT EXISTS tbuf
	(
		icodigo     serial NOT NULL,	-- CODIGO IDENTIFICADOR DA TABELA
		codigoibge  INTEGER NOT NULL,	-- Código Padrão da UF (IBGE).
		nmestado    VARCHAR (300) NOT NULL,	-- Nome do Estado.
		uf          VARCHAR (2) NOT NULL,	-- Unidade Federativa (UF).
		CONSTRAINT tbuf_pkey PRIMARY KEY (icodigo)
	) WITH (OIDS = FALSE); 
	
	ALTER TABLE tbuf 
	OWNER TO postgres; 
	
	COMMENT ON COLUMN tbuf.icodigo IS 'código identificador da tabela'; 
	COMMENT ON COLUMN tbuf.codigoibge IS 'Código Padrão da UF (IBGE).'; 
	COMMENT ON COLUMN tbuf.nmestado IS 'Nome do Estado.'; 
	COMMENT ON COLUMN tbuf.uf IS 'Unidade Federativa (UF).';

	END IF;
	/*
	* Insere estados (UF)
	*/

	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'11',
		'Rondônia',
		'RO'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '11'
	       );

	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'12',
		'Acre',
		'AC'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '12'
	       );

	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'13',
		'Amazonas',
		'AM'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '13'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'14',
		'Roraima',
		'RR'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '14'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'15',
		'Pará',
		'PA'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '15'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'16',
		'Amapá',
		'AP'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '16'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'17',
		'Tocantins',
		'TO'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '17'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'21',
		'Maranhão',
		'MA'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '21'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'22',
		'Piauí',
		'PI'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '22'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'23',
		'Ceará',
		'CE'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '23'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'24',
		'Rio Grande do Norte',
		'RN'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '24'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'25',
		'Paraíba',
		'PB'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '25'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'26',
		'Pernambuco',
		'PE'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '26'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'27',
		'Alagoas',
		'AL'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '27'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'28',
		'Sergipe',
		'SE'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '28'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'29',
		'Bahia',
		'BA'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '29'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'31',
		'Minas Gerais',
		'MG'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '31'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'32',
		'Espírito Santo',
		'ES'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '32'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'33',
		'Rio de Janeiro',
		'RJ'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '33'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'35',
		'São Paulo',
		'SP'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '35'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'41',
		'Paraná',
		'PR'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '41'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'42',
		'Santa Catarina',
		'SC'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '42'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'43',
		'Rio Grande do Sul',
		'RS'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '43'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'50',
		'Mato Grosso do Sul',
		'MS'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '50'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'51',
		'Mato Grosso',
		'MT'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '51'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'52',
		'Goiás',
		'GO'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '52'
	       );

	
	
	INSERT INTO tbuf
	(codigoibge, nmestado, uf)
	SELECT
		'53',
		'Distrito Federal',
		'DF'
	 WHERE NOT EXISTS (
	       	SELECT
	       		NULL
	       	FROM tbuf
	       	 WHERE codigoibge = '53'
	       ); 
	
	
	/*
	- Cria coluna iEstado na tabela de Cidades
	*/
	IF  NOT EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbcidade'
	    	   AND COLUMN_NAME = 'iuf'
	    )
	THEN
		ALTER TABLE tbcidade ADD COLUMN iuf INT NULL; 
		COMMENT ON COLUMN tbuf.icodigo IS 
		'indica o identificador da tabela de estados (uf).';
	END IF;
	
	IF EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbcidade'
	    	   AND COLUMN_NAME = 'suf'
	    )
	THEN
		UPDATE tbcidade
		SET    iuf = u.icodigo
		FROM   tbcidade c
			   LEFT JOIN tbuf u
					ON  u.uf = c.suf
		WHERE  tbcidade.icodigo = c.icodigo;
	END IF;
	
	/*
	* Altera view de Pedido para contemplar a tabela de uf
	*/
	DROP VIEW vwPedido;

	CREATE OR REPLACE VIEW vwpedido AS 
	SELECT tbpedido.icodigo
		  ,COALESCE(tbpedido.icliente, 0) AS icliente
		  ,tbpedido.ddatapedido
		  ,tbpedido.thorapedido
		  ,tbpedido.ntotalprodutos
		  ,tbpedido.najustepercentual
		  ,tbnatureza.sdescricao AS natureza
		  ,tbpedido.icfop AS cfop
		  ,COALESCE(
			   COALESCE(tbconsumidor.snome, tbpessoa.snome),
			   'CONSUMIDOR'::character VARYING
		   ) AS cliente
		  ,COALESCE(tbconsumidor.sendereco, tbpessoa.sendereco) AS sendereco
		  ,COALESCE(tbconsumidor.sbairro, tbpessoa.sbairro) AS sbairro
		  ,COALESCE(tbconsumidor.scep, tbpessoa.scep::character VARYING) AS scep
		  ,COALESCE(tbpessoafisica.scpf, tbpessoajuridica.scnpj) AS cpf_cnpj
		  ,COALESCE(tbcidadeconsumidor.snome, tbcidade.snome) AS cidade
		  ,COALESCE(tbufconsumidor.uf, tbuf.uf) AS suf
		  ,COALESCE(tbconsumidor.sfone, tbpessoa.sfone::character VARYING) AS sfone
		  ,tbpessoajuridica.sinscestadual
		  ,(tbproduto.sdescricao::TEXT || ' - '::TEXT) || tbproduto.sreferencia::TEXT AS sdescricao
		  ,tbmarca.sdescricao AS marca
		  ,tbproduto.icodigo AS iproduto
		  ,tbunidade.sdescricao AS unidade
		  ,tbcodigofiscal.nicmspf
		  ,tbcodigofiscal.nicmspj
		  ,tbpedido.sobservacao
		  ,tbpedidoitens.nquantidade
		  ,tbpedidoitens.nvalor
		  ,tbpedidoitens.nquantidade * tbpedidoitens.nvalor AS totalitem
		  ,CASE 
				WHEN tbpedido.najustepercentual > 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC)
				ELSE 0.00
		   END AS totalacresc
		  ,CASE 
				WHEN tbpedido.najustepercentual < 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC)
				ELSE 0.00
		   END AS totaldesc
		  ,(
			   tbpedidoitens.nvalor +
			   CASE 
					WHEN tbpedido.najustepercentual < 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC) 
						 / tbpedidoitens.nquantidade
					ELSE 0.00
			   END +
			   CASE 
					WHEN tbpedido.najustepercentual > 0::NUMERIC THEN tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC) 
						 / tbpedidoitens.nquantidade
					ELSE 0.00
			   END
		   )::NUMERIC(12, 2) AS nvalorcomajuste
		  ,(
			   tbpedidoitens.nquantidade * tbpedidoitens.nvalor + tbpedidoitens.nquantidade * tbpedidoitens.nvalor * (tbpedido.najustepercentual / 100::NUMERIC)
		   )::NUMERIC(12, 2) AS totalitemcomajuste
		  ,tbpedido.sstatus
		  ,CASE 
				WHEN tbpedido.bpedido = TRUE AND tbpedido.icodnotafiscal IS NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = FALSE THEN 'Pedido'::TEXT
				WHEN tbpedido.bpedido = FALSE AND tbpedido.icodnotafiscal IS NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = FALSE THEN 'Orçamento'::TEXT
				WHEN tbpedido.bpedido = TRUE AND tbpedido.icodnotafiscal IS NOT NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = FALSE THEN 'NF'::TEXT
				WHEN tbpedido.bpedido = FALSE AND tbpedido.icodnotafiscal IS NULL AND COALESCE(tbpedido.bcupomfiscal, FALSE) 
					 = TRUE THEN 'CF'::TEXT
				ELSE NULL::TEXT
		   END::character VARYING(10) AS tipo
		  ,nf.inotafiscal
	FROM   tbpedido
	JOIN tbpedidoitens ON tbpedidoitens.ipedido = tbpedido.icodigo
	LEFT JOIN tbnotafiscal nf ON nf.icodigo = tbpedido.icodnotafiscal
	LEFT JOIN tbcliente ON tbcliente.icodigo = tbpedido.icliente
	LEFT JOIN tbpessoa ON tbpessoa.icodigo = tbcliente.icodigo
	JOIN tbproduto ON tbproduto.icodigo = tbpedidoitens.iproduto
	JOIN tbnatureza ON tbnatureza.icodigo = tbpedido.inatureza
	LEFT JOIN tbpessoafisica ON tbpessoafisica.icodigo = tbpessoa.icodigo
	LEFT JOIN tbpessoajuridica ON tbpessoajuridica.icodigo = tbpessoa.icodigo
	LEFT JOIN tbcidade ON tbcidade.icodigo = tbpessoa.icidade
	LEFT JOIN tbuf ON tbuf.icodigo = tbcidade.iuf
	JOIN tbunidade ON tbunidade.icodigo = tbproduto.iundsaida
	JOIN tbcodigofiscal ON tbcodigofiscal.icodigo = tbpedido.icfop
	JOIN tbmarca ON tbmarca.icodigo = tbproduto.imarca
	LEFT JOIN tbconsumidor ON tbconsumidor.ipedido = tbpedido.icodigo
	LEFT JOIN tbcidade tbcidadeconsumidor ON tbcidadeconsumidor.icodigo = tbconsumidor.icidade
	LEFT JOIN tbuf tbufconsumidor ON tbufconsumidor.icodigo = tbcidadeconsumidor.iuf 
	WHERE  tbpedido.sstatus = 'A'::bpchar;
	
	/*
	- Apaga coluna suf da tabela tbcidade
	*/
	IF EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbcidade'
	    	   AND COLUMN_NAME = 'suf'
	    )
	THEN
		ALTER TABLE tbcidade DROP COLUMN suf; 
	END IF;	
	
	/*
	- Cria view de empresa
	*/
	CREATE OR REPLACE VIEW vwEmpresa
	AS
	select 
		e.*,
		c.snome as scidade,
		c.scodibge as scodibgecidade,
		c.iuf,
		u.nmestado as sestado,
		u.uf as suf,
		u.codigoibge as scodibgeuf
	from tbempresa e
	inner join tbcidade c on c.icodigo = e.icidade
	inner join tbuf u on u.icodigo = c.iuf;	
	
	/*
	* Cria parametro de Versão da NF
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodVerNFE'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Versão de NFE', 'CodVerNFE', '2', 1);
	END IF;	
	
	/*
	* Cria parametro Tipo da NF
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodTpoNFE'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Tipo de NFE', 'CodTpoNFE', '1', 1);
	END IF;		

	/*
	* Cria parametro Formato DANFE
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodFormatoDanfe'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Formato do Danfe', 'CodFormatoDanfe', '1', 1);
	END IF;			
	
	/*
	* Cria parametro Forma de Emissão
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodFormaEmissao'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código da Forma de Emissão', 'CodFormaEmissao', '1', 1);
	END IF;		
	
	/*
	* Cria parametro Código do Ambiente NFE
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodAmbienteNfe'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código do Ambiente de NFE (1 = producao 2 = homologacao)', 'CodAmbienteNfe', '1', 1);
	END IF;			
	
	/*
	* Cria parametro Código da Finalidade NFE
	*/	
	IF  NOT EXISTS(
	    	SELECT NULL FROM tbparametro
	    	WHERE sparametro = 'CodFinalidadeNFE'
	    )
	THEN
		INSERT INTO tbparametro
		(sdescricao, sparametro, svalor, iempresa)
		VALUES
		('Código da Finalidade de NFE', 'CodFinalidadeNFE', '1', 1);
	END IF;	
	
	/*
	* Cria tabela de Estados (UF)
	*/ 
	IF  NOT EXISTS(
	    	SELECT NULL FROM information_schema.tables
	    	WHERE TABLE_NAME      = 'tbpais'
	    )
	THEN
	CREATE TABLE IF NOT EXISTS tbpais
	(
		icodigo     serial NOT NULL,		-- CODIGO IDENTIFICADOR DA TABELA
		icodigopais VARCHAR (10) NOT NULL,	-- Código Nacional do País
		sPais       VARCHAR (300) NOT NULL,	-- Nome do País.
		CONSTRAINT tbpais_pkey PRIMARY KEY (icodigo)
	) WITH (OIDS = FALSE); 
	
	ALTER TABLE tbpais 
	OWNER TO postgres; 
	
	COMMENT ON COLUMN tbpais.icodigo IS 'código identificador da tabela'; 
	COMMENT ON COLUMN tbpais.icodigopais IS 'Código Nacional do País'; 
	COMMENT ON COLUMN tbpais.sPais IS 'Nome do País.'; 

	END IF;	

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00132'
		  ,'Afeganistão'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00132'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00175'
		  ,'Republica Da Albania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00175'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00230'
		  ,'Alemanha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00230'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00310'
		  ,'Burkina Faso'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00310'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00370'
		  ,'Andorra'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00370'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00400'
		  ,'Angola'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00400'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00418'
		  ,'Anguilla'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00418'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00434'
		  ,'Antigua E Barbuda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00434'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00531'
		  ,'Arabia Saudita'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00531'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00639'
		  ,'Argentina'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00639'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00647'
		  ,'Republica Da Armenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00647'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00698'
		  ,'Australia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00698'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00728'
		  ,'Austria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00728'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00736'
		  ,'Republica Do Azerbaijao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00736'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00779'
		  ,'Ilhas Bahamas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00779'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00809'
		  ,'Ilhas Bahrein'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00809'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00817'
		  ,'Bangladesh'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00817'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00833'
		  ,'Barbados'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00833'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00850'
		  ,'Republica Da Belarus'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00850'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00876'
		  ,'Belgica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00876'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00884'
		  ,'Belize'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00884'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00906'
		  ,'Bermudas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00906'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00930'
		  ,'Mianmar (Birmania)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00930'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00973'
		  ,'Bolivia, Estado Plurinacional Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00973'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '00981'
		  ,'Bosnia-Herzegovina (Republica Da)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '00981'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01015'
		  ,'Botsuana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01015'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01058'
		  ,'Brasil'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01058'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01082'
		  ,'Brunei'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01082'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01112'
		  ,'Bulgaria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01112'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01155'
		  ,'Burundi'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01155'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01198'
		  ,'Butao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01198'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01279'
		  ,'Republica De Cabo Verde'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01279'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01376'
		  ,'Ilhas Cayman'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01376'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01414'
		  ,'Camboja'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01414'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01457'
		  ,'Camaroes'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01457'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01490'
		  ,'Canada'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01490'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01504'
		  ,'Ilha Do Canal Guernsey'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01504'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01508'
		  ,'Ilha Do Canal Jersey'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01508'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01511'
		  ,'Ilhas Canarias'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01511'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01538'
		  ,'Republica Do Cazaquistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01538'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01546'
		  ,'Catar'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01546'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01589'
		  ,'Chile'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01589'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01600'
		  ,'China'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01600'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01619'
		  ,'Formosa (Taiwan)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01619'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01635'
		  ,'Chipre'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01635'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01651'
		  ,'Ilhas Cocos(Keeling)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01651'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01694'
		  ,'Colombia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01694'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01732'
		  ,'Ilhas Comores'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01732'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01775'
		  ,'Congo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01775'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01830'
		  ,'Ilhas Cook'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01830'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01872'
		  ,'Coreia (Do Norte), Rep.Pop.Democratica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01872'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01902'
		  ,' Republica Da Coreia (Do Sul)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01902'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01937'
		  ,'Costa Do Marfim'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01937'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01953'
		  ,'Croacia (Republica)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01953'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01961'
		  ,'Costa Rica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01961'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01988'
		  ,'Coveite'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01988'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '01996'
		  ,'Cuba'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '01996'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02291'
		  ,'Benin'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02291'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02321'
		  ,'Dinamarca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02321'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02356'
		  ,'Dominica,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02356'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02399'
		  ,'Equador'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02399'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02402'
		  ,'Egito'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02402'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02437'
		  ,'Eritreia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02437'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02445'
		  ,'Emirados Arabes Unidos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02445'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02453'
		  ,'Espanha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02453'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02461'
		  ,'Republica Da Eslovenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02461'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02470'
		  ,'Republica Eslovaca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02470'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02496'
		  ,'Estados Unidos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02496'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02518'
		  ,'Republica Da Estonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02518'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02534'
		  ,'Etiopia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02534'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02550'
		  ,'Falkland (Ilhas Malvinas)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02550'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02593'
		  ,'Ilhas Feroe'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02593'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02674'
		  ,'Filipinas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02674'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02712'
		  ,'Finlandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02712'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02755'
		  ,'Franca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02755'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02810'
		  ,'Gabao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02810'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02852'
		  ,'Gambia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02852'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02895'
		  ,'Gana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02895'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02917'
		  ,'Republica Da Georgia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02917'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02933'
		  ,'Gibraltar'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02933'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '02976'
		  ,'Granada'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '02976'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03018'
		  ,'Grecia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03018'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03050'
		  ,'Groenlandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03050'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03093'
		  ,'Guadalupe'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03093'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03131'
		  ,'Guam'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03131'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03174'
		  ,'Guatemala'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03174'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03255'
		  ,'Guiana Francesa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03255'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03298'
		  ,'Guine'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03298'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03310'
		  ,'Guine-Equatorial'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03310'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03344'
		  ,'Guine-Bissau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03344'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03379'
		  ,'Guiana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03379'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03417'
		  ,'Haiti'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03417'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03450'
		  ,'Honduras'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03450'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03514'
		  ,'Hong Kong'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03514'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03557'
		  ,'Republica Da Hungria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03557'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03573'
		  ,'Iemen'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03573'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03595'
		  ,'Man, Ilha De'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03595'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03611'
		  ,'India'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03611'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03654'
		  ,'Indonesia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03654'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03697'
		  ,'Iraque'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03697'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03727'
		  ,'Republica Islamica Do Ira'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03727'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03751'
		  ,'Irlanda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03751'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03794'
		  ,'Islandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03794'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03832'
		  ,'Israel'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03832'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03867'
		  ,'Italia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03867'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03913'
		  ,'Jamaica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03913'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03964'
		  ,'Ilhas Johnston'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03964'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '03999'
		  ,'Japao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '03999'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04030'
		  ,'Jordania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04030'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04111'
		  ,'Kiribati'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04111'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04200'
		  ,'Laos, Rep.Pop.Democr.Do'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04200'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04235'
		  ,'Ilhas Lebuan'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04235'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04260'
		  ,'Lesoto'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04260'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04278'
		  ,'Republica Da Letonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04278'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04316'
		  ,'Libano'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04316'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04340'
		  ,'Liberia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04340'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04383'
		  ,'Libia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04383'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04405'
		  ,'Liechtenstein'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04405'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04421'
		  ,'Republica Da Lituania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04421'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04456'
		  ,'Luxemburgo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04456'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04472'
		  ,'Macau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04472'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04499'
		  ,'Macedonia, Ant.Rep.Iugoslava'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04499'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04502'
		  ,'Madagascar'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04502'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04525'
		  ,'Madeira, Ilha Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04525'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04553'
		  ,'Malasia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04553'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04588'
		  ,'Malavi'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04588'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04618'
		  ,'Maldivas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04618'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04642'
		  ,'Mali'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04642'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04677'
		  ,'Malta'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04677'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04723'
		  ,'Marianas Do Norte'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04723'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04740'
		  ,'Marrocos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04740'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04766'
		  ,'Ilhas Marshall'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04766'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04774'
		  ,'Martinica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04774'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04855'
		  ,'Mauricio'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04855'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04880'
		  ,'Mauritania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04880'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04885'
		  ,'Mayotte (Ilhas Francesas)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04885'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04901'
		  ,'Ilhas Midway'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04901'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04936'
		  ,'Mexico'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04936'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04944'
		  ,'Republica Da Moldavia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04944'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04952'
		  ,'Monaco'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04952'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04979'
		  ,'Mongolia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04979'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04985'
		  ,'Montenegro'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04985'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '04995'
		  ,'Micronesia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '04995'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05010'
		  ,'Ilhas Montserrat'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05010'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05053'
		  ,'Mocambique'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05053'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05070'
		  ,'Namibia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05070'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05088'
		  ,'Nauru'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05088'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05118'
		  ,'Christmas,Ilha (Navidad)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05118'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05177'
		  ,'Nepal'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05177'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05215'
		  ,'Nicaragua'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05215'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05258'
		  ,'Niger'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05258'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05282'
		  ,'Nigeria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05282'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05312'
		  ,'Niue,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05312'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05355'
		  ,'Norfolk,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05355'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05380'
		  ,'Noruega'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05380'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05428'
		  ,'Nova Caledonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05428'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05452'
		  ,'Papua Nova Guine'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05452'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05487'
		  ,'Nova Zelandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05487'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05517'
		  ,'Vanuatu'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05517'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05568'
		  ,'Oma'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05568'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05665'
		  ,'Ilhas Do Pacifico (Possessao Dos Eua)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05665'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05738'
		  ,'Paises Baixos (Holanda)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05738'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05754'
		  ,'Palau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05754'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05762'
		  ,'Paquistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05762'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05800'
		  ,'Panama'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05800'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05860'
		  ,'Paraguai'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05860'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05894'
		  ,'Peru'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05894'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05932'
		  ,'Pitcairn,Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05932'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '05991'
		  ,'Polinesia Francesa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '05991'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06033'
		  ,'Republica Da Polonia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06033'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06076'
		  ,'Portugal'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06076'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06114'
		  ,'Porto Rico'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06114'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06238'
		  ,'Quenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06238'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06254'
		  ,'Republica Quirguiz'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06254'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06289'
		  ,'Reino Unido'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06289'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06408'
		  ,'Republica Centro-Africana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06408'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06475'
		  ,'Republica Dominicana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06475'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06602'
		  ,'Reuniao, Ilha'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06602'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06653'
		  ,'Zimbabue'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06653'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06700'
		  ,'Romenia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06700'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06750'
		  ,'Ruanda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06750'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06769'
		  ,'Russia, Federacao Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06769'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06777'
		  ,'Ilhas Salomao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06777'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06858'
		  ,'Saara Ocidental'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06858'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06874'
		  ,'El Salvador'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06874'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06904'
		  ,'Samoa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06904'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06912'
		  ,'Samoa Americana'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06912'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06955'
		  ,'Ilhas Sao Cristovao E Neves'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06955'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '06971'
		  ,'San Marino'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '06971'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07005'
		  ,'Sao Pedro E Miquelon'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07005'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07056'
		  ,'Sao Vicente E Granadinas'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07056'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07102'
		  ,'Santa Helena'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07102'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07153'
		  ,'Santa Lucia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07153'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07200'
		  ,'Ilhas Sao Tome E Principe'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07200'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07285'
		  ,'Senegal'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07285'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07315'
		  ,'Seychelles'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07315'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07358'
		  ,'Serra Leoa'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07358'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07370'
		  ,'Servia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07370'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07412'
		  ,'Cingapura'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07412'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07447'
		  ,'Republica Arabe Da Siria'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07447'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07480'
		  ,'Somalia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07480'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07501'
		  ,'Sri Lanka'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07501'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07544'
		  ,'Suazilandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07544'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07560'
		  ,'Africa Do Sul'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07560'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07595'
		  ,'Sudao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07595'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07641'
		  ,'Suecia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07641'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07676'
		  ,'Suica'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07676'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07706'
		  ,'Suriname'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07706'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07722'
		  ,'Republica Do Tadjiquistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07722'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07765'
		  ,'Tailandia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07765'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07803'
		  ,'Tanzania, Rep.Unida Da'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07803'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07820'
		  ,'Territorio Brit.Oc.Indico'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07820'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07838'
		  ,'Djibuti'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07838'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07889'
		  ,'Chade'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07889'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07919'
		  ,'Republica Tcheca'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07919'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '07951'
		  ,'Timor Leste'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '07951'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08001'
		  ,'Togo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08001'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08052'
		  ,'Ilhas Toquelau'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08052'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08109'
		  ,'Tonga'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08109'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08150'
		  ,'Trinidad E Tobago'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08150'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08206'
		  ,'Tunisia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08206'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08230'
		  ,'Ilhas Turcas E Caicos'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08230'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08249'
		  ,'Republica Do Turcomenistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08249'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08273'
		  ,'Turquia'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08273'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08281'
		  ,'Tuvalu'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08281'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08311'
		  ,'Ucrania'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08311'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08338'
		  ,'Uganda'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08338'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08451'
		  ,'Uruguai'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08451'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08478'
		  ,'Republica Do Uzbequistao'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08478'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08486'
		  ,'Est. Da Cidade Do Vaticano'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08486'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08508'
		  ,'Venezuela'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08508'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08583'
		  ,'Vietna'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08583'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08630'
		  ,'Ilhas Virgens (Britanicas)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08630'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08664'
		  ,'Ilhas Virgens (E.U.A.)'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08664'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08702'
		  ,'Fiji'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08702'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08737'
		  ,'Ilha Wake'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08737'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08885'
		  ,'Republica Democratica Do Congo'
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08885'
		   );

	INSERT INTO tbpais 
			(icodigopais ,spais)
	SELECT '08907'
		  ,'Zambia'
		
	WHERE  NOT EXISTS (
			   SELECT NULL
			   FROM   tbpais
			   WHERE  icodigopais = '08907'
		   );
		   
	/*
	- Altera Coluna iUF para Não aceitar NULL.
	*/
	IF EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbcidade'
	    	   AND COLUMN_NAME = 'iuf'
	    )
	THEN
		ALTER TABLE tbcidade ALTER COLUMN iuf SET NOT NULL; 
	END IF;	
	
	/*
	- Adiciona coluna ipais na tabela de estado (tbuf)
	*/
	IF NOT EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbuf'
	    	   AND COLUMN_NAME = 'ipais'
	    )
	THEN
		ALTER TABLE tbuf ADD COLUMN ipais INT NULL; 
	END IF;	
	
	/*
	- Adiciona coluna ipais na tabela de estado (tbuf)
	*/
	IF EXISTS(
	    	SELECT
	    		NULL
	    	FROM information_schema.columns
	    	 WHERE TABLE_NAME = 'tbuf'
	    	   AND COLUMN_NAME = 'ipais'
	    )
	THEN
		UPDATE tbuf set ipais = (select icodigo from tbpais where icodigopais = '01058');
		ALTER TABLE tbuf ALTER COLUMN ipais SET NOT NULL; 
	END IF;	
	
	/*
	- Altera view de Empresa para adicionar tabela de paises.
	*/	
	CREATE OR REPLACE VIEW vwempresa AS 
	 SELECT e.*, 
		c.snome AS scidade, 
		c.scodibge AS scodibgecidade, 
		c.iuf, 
		u.nmestado AS sestado, 
		u.uf AS suf, 
		u.codigoibge AS scodibgeuf,
		p.icodigopais as scodibgepais, 
		p.spais
	   FROM tbempresa e
	   JOIN tbcidade c ON c.icodigo = e.icidade
	   JOIN tbuf u ON u.icodigo = c.iuf
	   JOIN tbpais p ON p.icodigo = u.ipais;

	ALTER TABLE vwempresa
	  OWNER TO postgres;	
/*
	* Cria VW para Emissão da NF
	*/
	CREATE OR REPLACE VIEW vwNF
	AS
	SELECT tbnatureza.sdescricao AS Natureza_Operacao
		  ,tbpedido.icfop AS CFOP
		  ,COALESCE(tbpessoajuridica.srazaosocial, tbpessoa.snome) AS nome
		  ,tbpessoa.sendereco
		  ,tbpessoa.sbairro
		  ,tbpessoa.scep
		  ,COALESCE(tbpessoafisica.scpf, tbpessoajuridica.scnpj) AS cpf_cnpj
		  ,tbcidade.snome AS cidade
		  ,u.uf
		  ,tbpessoa.sfone
		  ,COALESCE(tbpessoajuridica.sinscestadual, tbpessoafisica.srg) AS sinscestadual
		  ,tbproduto.sdescricao || ' - ' || tbproduto.sreferencia AS sdescricao
		  ,tbmarca.sdescricao AS marca
		  ,tbproduto.icodigo
		  ,tbproduto.incm
		  ,tbunidade.sdescricao AS unidade
		  ,tbpedidoitens.nquantidade
		  ,tbpedidoitens.nvalor
		  ,tbpedidoitens.nquantidade *
		   tbpedidoitens.nvalor AS totalitem
		  ,tbpedido.ddatapedido
		  ,tbcodigofiscal.nicmspf
		  ,tbcodigofiscal.nicmspj
		  ,tbpedido.sobservacao
		  ,tbpedido.najustepercentual
		  ,tbpedido.najustevalor
		  ,tbcidade.scodibge
		  ,tbpedido.icodigo AS pedido
		  ,nf.inotafiscal AS B_NNF
		  ,tbpedido.iempresa
	FROM   tbpedido
	JOIN tbpedidoitens ON tbpedidoitens.ipedido = tbpedido.icodigo
	LEFT JOIN tbnotafiscal nf ON nf.icodigo = tbpedido.icodnotafiscal
	JOIN tbcliente ON tbcliente.icodigo = tbpedido.icliente
	JOIN tbpessoa ON tbpessoa.icodigo = tbcliente.icodigo
	JOIN tbproduto ON tbproduto.icodigo = tbpedidoitens.iproduto
	JOIN tbnatureza ON tbnatureza.icodigo = tbpedido.inatureza
	LEFT OUTER JOIN tbpessoafisica ON tbpessoafisica.icodigo = tbpessoa.icodigo
	LEFT OUTER JOIN tbpessoajuridica ON tbpessoajuridica.icodigo = tbpessoa.icodigo
	JOIN tbcidade ON tbcidade.icodigo = tbpessoa.icidade
	JOIN tbuf u on u.icodigo = tbcidade.iuf
	JOIN tbpais p on p.icodigo = u.ipais
	JOIN tbunidade ON tbunidade.icodigo = tbproduto.iundsaida
	JOIN tbcodigofiscal ON tbcodigofiscal.icodigo = tbpedido.icfop
	JOIN tbmarca ON tbmarca.icodigo = tbproduto.imarca
	WHERE  tbproduto.sservico = 'N';	  
	
END;	
$$ LANGUAGE plpgsql;
SELECT script_71();
DROP FUNCTION script_71 ();

SELECT setval ('tbuf_icodigo_seq', 1); 	
SELECT setval ('tbpais_icodigo_seq', 1); 	